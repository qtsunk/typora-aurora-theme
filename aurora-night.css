:root {
    --side-bar-bg-color: #25282c;
    --control-text-color: #c5c5c5;
    --primary-color: #6a99cc;
    --secondary-color: #adb5bd;
    --border-color: #333;
    --header-border-color: #444;
    --code-bg-color: #2d3035;
    --quote-bg-color: rgba(30, 40, 50, 0.6);
    --table-header-bg: #2a2d33;
    --table-alt-bg: #2a2d32;
    --shadow-color: rgba(0, 0, 0, 0.6);
    --task-checked-color: #28a745;
    --sidebar-hover-bg: rgba(74, 111, 165, 0.12);
    --quote-border-color: #6a8cc6;
    --bg-color: #1e1f22;
    --item-hover-bg-color: rgba(77,139,219,0.12);
    --item-hover-text-color: #ffffff;
    --window-border: 1px solid #333;
    --active-file-bg-color: #222;
    --active-file-border-color: #8d8df0;
    --active-file-text-color: #ffffff;
    --select-text-bg-color: #4a89dc;
    --search-select-bg-color: #428bca;
}

body {
    font-family: "Open Sans", "Clear Sans", "Helvetica Neue", Helvetica, Arial, "Microsoft YaHei", sans-serif;
    color: #e6e6e6;
    line-height: 1.65;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    font-size: 97%;
    background-color: #1e1f22;
    padding-bottom: 80px;
}

#write {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0;
}

h1, h2, h3, h4, h5, h6 {
    position: relative;
    margin-top: 1.8em;
    margin-bottom: 1em;
    font-weight: 600;
    color: #f0f0f0;
    padding-bottom: 0.3em;
    border-bottom: 1px solid var(--border-color);
    transition: all 0.2s ease;
}

h1 {
    font-size: 1.95rem;
    border-bottom: 2px solid var(--header-border-color);
    padding-bottom: 0.4em;
    margin-top: 0;
}

h2 {
    font-size: 1.65rem;
    border-bottom: 1.5px solid var(--header-border-color);
}

h3 {
    font-size: 1.4rem;
    border-bottom: 1px dashed var(--border-color);
}

h4 {
    font-size: 1.2rem;
    color: #ccc;
    border-bottom: none;
}

h5 {
    font-size: 1.05rem;
    color: var(--secondary-color);
    border-bottom: none;
}

h6 {
    font-size: 0.95rem;
    color: var(--control-text-color);
    border-bottom: none;
    font-weight: 600;
    margin-top: 1.5em;
}

p, blockquote, ul, ol, dl, table {
    font-size: 15px;
    margin-bottom: 1.1em;
    line-height: 1.65;
}

/* 限制链接样式只在编辑区域内生效 */
#write a {
    color: var(--primary-color);
    text-decoration: none;
    transition: all 0.2s ease;
    border-bottom: 1px solid rgba(106, 153, 204, 0.3);
    padding-bottom: 2px;
}

#write a:hover {
    color: #2c5282;
    border-bottom-color: var(--primary-color);
}

/* 修正表格内的链接样式 */
#write table a {
    border-bottom: none !important;
    text-decoration: none !important;
    background-image: none !important;
}

blockquote {
    border-left: 3px solid var(--quote-border-color);
    padding: 1em 1.3em;
    background-color: var(--quote-bg-color);
    border-radius: 0 4px 4px 0;
    margin: 1.6em 0;
    color: #c5c5c5;
    font-style: italic;
    position: relative;
}

blockquote::before {
    content: "“";
    position: absolute;
    top: -15px;
    left: 5px;
    font-size: 4rem;
    color: rgba(106, 153, 204, 0.1);
    font-family: serif;
    line-height: 1;
}

blockquote blockquote {
    padding-right: 0;
    border-left: 2px solid #adb5bd;
}

#write .md-fences, #write code, #write tt {
    font-size: 13px;
    background-color: var(--code-bg-color);
    border-radius: 4px;
    font-family: "Fira Code", "Source Code Pro", "Menlo", "Consolas", "DejaVu Sans Mono", monospace;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
}

#write code {
    padding: 0.2em 0.4em;
    margin: 0 2px;
    color: #e06c75;
    background-color: rgba(230, 230, 240, 0.03);
    border-radius: 3px;
    font-size: 0.93em;
}

#write .md-fences {
    margin: 1.8em 0;
    padding: 1.2em 1.5em;
    line-height: 1.5;
    border: 1px solid var(--border-color);
    position: relative;
}

.md-fences::before {
    content: attr(lang);
    position: absolute;
    top: 0.65em;
    right: 0.8em;
    font-size: 0.72em;
    color: var(--control-text-color);
    opacity: 0.8;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    background: rgba(255, 255, 255, 0.03);
    padding: 0 0.4em;
    border-radius: 2px;
    z-index: 1;
    line-height: 1;
    pointer-events: none;
}

table {
    width: 100%;
    border-collapse: collapse;
    margin: 1.8em 0;
    border-radius: 6px;
    overflow: hidden;
}

table tr {
    border-top: 1px solid var(--border-color);
    margin: 0;
    padding: 0;
}

table tr:nth-child(2n) {
    background-color: var(--table-alt-bg);
}

thead {
    background-color: var(--table-header-bg);
}

table tr th {
    font-weight: 600;
    background-color: var(--table-header-bg);
    border: 1px solid var(--border-color);
    border-bottom: 2px solid var(--border-color);
    padding: 0.75em 0.9em;
    text-align: left;
    color: #e0e0e0;
    font-size: 15px;
}

table tr td {
    border: 1px solid var(--border-color);
    padding: 0.7em 0.9em;
    color: #ccc;
    font-size: 15px;
    background-color: #25282c;
}

ul, ol {
    padding-left: 2.2em;
    margin: 1.2em 0;
}

ul li, ol li {
    margin-bottom: 0.4em;
    position: relative;
}

ul li::marker {
    color: var(--primary-color);
    font-weight: bold;
}

ol li::marker {
    color: var(--secondary-color);
    font-weight: 500;
}

.md-task-list-item>input {
    margin-left: -1.5em;
    margin-top: 0.3em;
    transform: scale(1.2);
    border: 1px solid #adb5bd;
    border-radius: 3px;
}

.md-task-list-item>input:checked {
    background-color: var(--task-checked-color);
    border-color: var(--task-checked-color);
}

hr {
    height: 1px;
    margin: 2.5em 0;
    border: 0;
    background: linear-gradient(to right, transparent, var(--border-color), transparent);
}

.md-task-list-item>input {
    transition: all 0.2s ease;
}

.md-task-list-item>input:hover {
    border-color: var(--primary-color);
    transform: scale(1.3);
}

h1:hover a.anchor,
h2:hover a.anchor,
h3:hover a.anchor,
h4:hover a.anchor,
h5:hover a.anchor,
h6:hover a.anchor {
    text-decoration: none;
    opacity: 0.8;
}

h2:hover, h3:hover {
    border-bottom-color: var(--border-color);
}

#typora-sidebar {
    background-color: var(--side-bar-bg-color) !important;
    border-right: 1px solid var(--border-color);
}

.sidebar-menu-list-item {
    border-bottom: none !important;
}

.sidebar-menu-list-item .sidebar-menu-list-item {
    border-left: none !important;
}

.ty-sidebar-footer {
    border-top: 1px solid var(--border-color);
}

.ty-sidebar-footer-item {
    border-bottom: none !important;
}

/* Improve sidebar footer visibility: ensure text/icons are readable even when not hovered */
#typora-sidebar .ty-sidebar-footer {
    padding: 8px 6px;
    background: transparent;
}

#typora-sidebar .ty-sidebar-footer .ty-sidebar-footer-item,
#typora-sidebar .ty-sidebar-footer .ty-sidebar-footer-item .footer-item,
#typora-sidebar .ty-sidebar-footer .sidebar-footer-item {
    color: var(--control-text-color) !important;
    opacity: 1 !important;
}

/* Ensure icons and svgs use currentColor and stay visible */
#typora-sidebar .ty-sidebar-footer .ty-sidebar-footer-item i,
#typora-sidebar .ty-sidebar-footer .ty-sidebar-footer-item svg,
#typora-sidebar .ty-sidebar-footer .ty-sidebar-footer-item .icon {
    color: var(--control-text-color) !important;
    fill: currentColor !important;
}

/* Hover state: slightly brighter text */
#typora-sidebar .ty-sidebar-footer .ty-sidebar-footer-item:hover,
#typora-sidebar .ty-sidebar-footer .ty-sidebar-footer-item:hover i,
#typora-sidebar .ty-sidebar-footer .ty-sidebar-footer-item:hover svg {
    color: var(--item-hover-text-color) !important;
    fill: currentColor !important;
}

#ty-sidebar-search-item {
    border-bottom: 1px solid var(--border-color) !important;
}

.file-list-item {
    border-radius: 3px;
    margin: 2px 8px;
    padding-left: 8px !important;
    transition: all 0.2s ease;
}

.file-list-item.active {
    background-color: var(--active-file-bg-color);
    color: var(--active-file-text-color);
}

.file-list-item:hover {
    background-color: var(--item-hover-bg-color);
    color: var(--item-hover-text-color);
}

.file-node-content:hover {
    background-color: var(--item-hover-bg-color);
}

.file-node-icon, .file-node-open-state {
    visibility: visible !important;
}

.on-focus-mode blockquote {
    border-left-color: rgba(106, 153, 204, 0.3);
}

footer {
    position: relative;
    clear: both;
}

footer.ty-footer {
    background: #25282c;
    border-top: 1px solid var(--border-color);
    margin-top: 20px;
    font-size: 0.87em;
    max-width: calc(100% - 80px);
    margin-left: auto;
    margin-right: auto;
}

@media (max-width: 768px) {
    #write {
        padding: 25px;
    }

    footer.ty-footer {
        padding: 15px 25px;
        width: calc(100% - 50px);
    }

    h1 {
        font-size: 1.7rem;
    }

    h2 {
        font-size: 1.4rem;
    }
}

h1, h2, h3, h4, h5, h6 {
    color: #f0f0f0;
    border-bottom-color: #444;
}

h1 { border-bottom-color: #555; }
h2 { border-bottom-color: #555; }

h4 { color: #ccc; }

blockquote {
    border-left-color: #6a8cc6;
    background-color: rgba(30, 40, 50, 0.6);
    color: #c5c5c5;
}

#write a {
    color: #6a99cc;
    border-bottom-color: rgba(106, 153, 204, 0.3);
}

#write table a { border-bottom: none !important; }

table tr th {
    background-color: #2a2d33;
    color: #e0e0e0;
    border-color: #444;
}

table tr td {
    color: #ccc;
    border-color: #444;
    background-color: #25282c;
}

table tr:nth-child(2n) { background-color: #2a2d32; }

#write .md-fences, #write code { background-color: #2d3035; color: #d4d4d4; }

/* 更贴近官方 night.css 的侧边栏与滚动条/代码块样式 */
#typora-sidebar { background-color: var(--side-bar-bg-color) !important; border-right: var(--window-border) !important; }

.file-list-item.active { background-color: var(--active-file-bg-color); }
.file-list-item:hover { background-color: var(--item-hover-bg-color); color: var(--item-hover-text-color); }

/* 强制覆盖 Typora 可能存在的默认/内置样式，避免悬停时字体变黑 */
#typora-sidebar .file-list-item:hover,
#typora-sidebar .file-list-item.active,
#typora-sidebar .file-node-content:hover,
#typora-sidebar .file-list-item:hover .file-node-title,
#typora-sidebar .file-list-item.active .file-node-title {
    color: var(--item-hover-text-color) !important;
}

#typora-sidebar .file-node-title,
#typora-sidebar .file-node-content {
    color: var(--control-text-color);
}

/* scrollbar for dark */
.typora-node::-webkit-scrollbar { width: 8px; }
.typora-node::-webkit-scrollbar-thumb:vertical { background: rgba(230,230,230,0.12); }
.typora-node::-webkit-scrollbar-thumb:vertical:active { background: rgba(230,230,230,0.18); }

/* CodeMirror gutters */
.CodeMirror-gutters { background: #2b2d31; border-right: 1px solid transparent; }

/* pre / code adjustments */
pre.md-fences { background: #2b2d31; border: 1px solid rgba(255,255,255,0.03); }

/* CodeMirror token colors from official night theme */
.cm-s-inner .cm-variable,
.cm-s-inner .cm-operator,
.cm-s-inner .cm-property {
    color: #b8bfc6;
}

.cm-s-inner .cm-keyword {
    color: #C88FD0;
}

.cm-s-inner .cm-tag {
    color: #7DF46A;
}

.cm-s-inner .cm-attribute {
    color: #7575E4;
}

.CodeMirror div.CodeMirror-cursor {
    border-left: 1px solid #b8bfc6;
    z-index: 3;
}

.cm-s-inner .cm-string {
    color: #D26B6B;
}

.cm-s-inner .cm-comment,
.cm-s-inner.cm-comment {
    color: #DA924A;
}

.cm-s-inner .cm-header,
.cm-s-inner .cm-def,
.cm-s-inner.cm-header,
.cm-s-inner.cm-def {
    color: #8d8df0;
}

.cm-s-inner .cm-quote,
.cm-s-inner.cm-quote {
    color: #57ac57;
}

.cm-s-inner .cm-hr {
    color: #d8d5d5;
}

.cm-s-inner .cm-link {
    color: #d3d3ef;
}

.cm-s-inner .cm-negative {
    color: #d95050;
}

.cm-s-inner .cm-positive {
    color: #50e650;
}

.cm-s-inner .cm-string-2 {
    color: #f50;
}

.cm-s-inner .cm-meta,
.cm-s-inner .cm-qualifier {
    color: #b7b3b3;
}

.cm-s-inner .cm-builtin {
    color: #f3b3f8;
}

.cm-s-inner .cm-bracket {
    color: #997;
}

.cm-s-inner .cm-atom,
.cm-s-inner.cm-atom {
    color: #84B6CB;
}

.cm-s-inner .cm-number {
    color: #64AB8F;
}

.cm-s-inner .cm-variable-2 {
    color: #9FBAD5;
}

.cm-s-inner .cm-variable-3 {
    color: #1cc685;
}

.CodeMirror-selectedtext,
.CodeMirror-selected {
    background: #4a89dc;
    color: #fff !important;
    text-shadow: none;
}

/* markdown source mode tokens (sourcemode.dark.css) */
.cm-s-typora-default .cm-header,
.cm-s-typora-default .cm-property {
    color: #cebcca;
}

.CodeMirror.cm-s-typora-default div.CodeMirror-cursor{
    border-left: 3px solid #b8bfc6;
}

.cm-s-typora-default .cm-comment {
    color: #9FB1FF;
}

.cm-s-typora-default .cm-string {
    color: #A7A7D9;
}

.cm-s-typora-default .cm-atom, .cm-s-typora-default .cm-number {
    color: #848695;
    font-style: italic;
}

.cm-s-typora-default .cm-link {
    color: #95B94B;
}

.cm-s-typora-default .CodeMirror-activeline-background {
    background: rgba(51, 51, 51, 0.72);
}

.cm-s-typora-default .cm-comment, .cm-s-typora-default .cm-code {
    color: #8aa1e1;
}

/* mermaid dark hint */
:root { --mermaid-theme: night; }
[lang='mermaid'] .label { color: #333; }

/* syntax highlighting: highlight.js & token-based (Prism) common palette */
.hljs { display: block; overflow-x: auto; padding: 1rem; background: #27292c; color: #d6d6d6; border-radius: 6px; box-shadow: 0 1px 6px rgba(0,0,0,0.4); }
.hljs-comment, .hljs-quote { color: #6b7179; font-style: italic; }
.hljs-keyword, .hljs-selector-tag, .hljs-subst { color: #c792ea; font-weight: 600; }
.hljs-number, .hljs-literal, .hljs-variable, .hljs-template-variable, .hljs-tag .hljs-attr { color: #ffb86c; }
.hljs-string, .hljs-doctag, .hljs-title, .hljs-section, .hljs-selector-id { color: #98c379; }
.hljs-built_in, .hljs-builtin-name { color: #8be9fd; }
.hljs-attr, .hljs-symbol, .hljs-class .hljs-title { color: #ffd580; }
.hljs-name, .hljs-type { color: #8be9fd; }
.hljs-tag { color: #e06c75; }

/* Prism / token-based */
.token.comment, .token.prolog, .token.doctype, .token.cdata { color: #6b7179; font-style: italic; }
.token.punctuation { color: #c7c9c6; }
.token.property, .token.tag, .token.boolean, .token.number, .token.constant, .token.symbol { color: #ffb86c; }
.token.selector, .token.attr-name, .token.string, .token.char, .token.builtin, .token.inserted { color: #98c379; }
.token.operator, .token.entity, .token.url, .language-css .token.string, .style .token.string { color: #ffd580; }
.token.atrule, .token.attr-value, .token.keyword { color: #c792ea; }
.token.function, .token.class-name { color: #8be9fd; }

/* inline code */
#write code { color: #ffb86c; background-color: rgba(255,255,255,0.02); padding: 0.08em 0.28em; border-radius: 3px; }

/* fence adjustments for comfort */
pre.md-fences { padding: 1rem 1.1rem; }

footer.ty-footer { background: #25282c; border-top-color: #333; }

/* Fix: ensure popup menus (context / dropdown) are readable in sidebar/footer */
.context-menu,
.dropdown-menu,
.popover,
.megamenu-menu-panel,
.typora-quick-open,
.typora-quick-open .typora-quick-open-item,
.md-popover,
.menu-panel,
.popup-menu {
    background-color: rgba(30,30,30,0.95) !important;
    color: var(--control-text-color) !important;
    border-color: rgba(255,255,255,0.06) !important;
}

.context-menu li,
.context-menu a,
.dropdown-menu li,
.dropdown-menu a,
.megamenu-menu-panel a,
.typora-quick-open .typora-quick-open-item,
.menu-panel .menu-item,
.popup-menu .menu-item {
    color: var(--control-text-color) !important;
}

.context-menu .divider,
.dropdown-menu .divider,
.megamenu-menu-panel .divider {
    background-color: rgba(255,255,255,0.06) !important;
}

/* Hover / active state in menus */
.context-menu li:hover,
.dropdown-menu li:hover,
.megamenu-menu-panel li:hover,
.typora-quick-open .typora-quick-open-item:hover {
    background-color: rgba(77,139,219,0.12) !important;
    color: var(--item-hover-text-color) !important;
}

/* Ensure icons inside menus are visible */
.context-menu i,
.dropdown-menu i,
.megamenu-menu-panel i,
.context-menu svg,
.dropdown-menu svg {
    color: var(--control-text-color) !important;
    fill: currentColor !important;
}
